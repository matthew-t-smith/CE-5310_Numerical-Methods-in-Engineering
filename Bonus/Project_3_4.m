% Determine the velocity distribution of the fluid in the region shown in Fig. 3.28(a) for the following cases:
%     (a) u_0 = 1; (b) u_0 = 5; (c) u_0 = 100.

% Given Ax = b, A, x, b, u_i,j = dx/dX ~= (x_j - x_i)/(X_j - X_i)

A = [1.0250 -0.4000 0 0 -0.6250 0 0 0 0 0 0 0 0; -0.4000 1.9135 -0.2998 0 0 -1.0338 -0.1799 0 0 0 0 0 0; 0 -0.2998 2.1415 -0.4417 0 0 -1.4000 0 0 0 0 0 0; 0 0 -0.4417 1.0077 0 0 0 -0.5660 0 0 0 0 0; -0.6250 0 0 0 2.0500 -0.8000 0 0 -0.6250 0 0 0 0; 0 -1.0338 0 0 -0.8000 3.8097 -0.4401 0 0 -1.0000 -0.0595 -0.4764 0; 0 -0.1799 -1.4000 0 0 -0.4401 4.0492 -0.7067 0 0 0 -1.1159 -0.2067; 0 0 0 -0.5660 0 0 -0.7067 2.2161 0 0 0 0 -0.9433; 0 0 0 0 -0.6250 0 0 0 1.0250 -0.4000 0 0 0; 0 0 0 0 0 -1.0000 0 0 -0.4000 2.0667 -0.6667 0 0; 0 0 0 0 0 -0.0595 0 0 0 -0.6667 1.3788 -0.6526 0; 0 0 0 0 0 -0.4764 -1.1159 0 0 0 -0.6526 2.5098 -0.2650; 0 0 0 0 0 0 -0.2067 -0.9433 0 0 0 -0.2650 1.4150];
syms x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13
x = [x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13].';

% a)
ua = 1;
b = ua * [2 0 0 0 4 0 0 0 2 0 0 0 0].';

% b)
ub = 5;
b = ub * [2 0 0 0 4 0 0 0 2 0 0 0 0].';

% c)
uc = 100;
b = uc * [2 0 0 0 4 0 0 0 2 0 0 0 0].';

u = zeros(13);
% u(i,j) = (x(j) - x(i)) / (X(j) - X(i));
U = A\b;